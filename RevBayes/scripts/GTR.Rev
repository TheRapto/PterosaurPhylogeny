####The General Time Reversible (GTR) substitution model####

#Defining exchangeability rates and state frequencies
alpha1 <- v(1,1,1,1,1,1) # 6 for rates
alpha2 <- v(1,1,1,1) # 4 for state frequencies
er ~ dnDirichlet(alpha1)
freq ~ dnDirichlet(alpha2)

#Set up the Q-Matrix as a deterministic variable
Q := fnGTR(er, freq)
Q

#Defing a stochastic node
seq ~ dnPhyloCTMC(tree = tree, Q = Q, type = "Standard", branchRates = branch_rates)
seq.clamp(morpho)